# Performance Advisor Warnings

| name                         | title                        | level | facing   | categories      | description                                                                                                                                                                                                                                                 | detail                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | remediation                                                                                      | metadata                                                                | cache_key                                                                                         |
| ---------------------------- | ---------------------------- | ----- | -------- | --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.profiles\` has a row level security policy \`Users can view their own profile\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                               | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"profiles","type":"table","schema":"public"}                    | auth_rls_init_plan_public_profiles_Users can view their own profile                               |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.profiles\` has a row level security policy \`Users can update their own profile\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                             | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"profiles","type":"table","schema":"public"}                    | auth_rls_init_plan_public_profiles_Users can update their own profile                             |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.profiles\` has a row level security policy \`Users can insert their own profile\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                             | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"profiles","type":"table","schema":"public"}                    | auth_rls_init_plan_public_profiles_Users can insert their own profile                             |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.user_activity_log\` has a row level security policy \`Users can view their own activity\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                     | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"user_activity_log","type":"table","schema":"public"}           | auth_rls_init_plan_public_user_activity_log_Users can view their own activity                     |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_sessions\` has a row level security policy \`Users can view their own chat sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                    | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_sessions","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_sessions_Users can view their own chat sessions                    |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_sessions\` has a row level security policy \`Users can create their own chat sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                  | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_sessions","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_sessions_Users can create their own chat sessions                  |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_sessions\` has a row level security policy \`Users can update their own chat sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                  | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_sessions","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_sessions_Users can update their own chat sessions                  |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_sessions\` has a row level security policy \`Users can delete their own chat sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                  | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_sessions","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_sessions_Users can delete their own chat sessions                  |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_messages\` has a row level security policy \`Users can view messages from their sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.               | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_messages","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_messages_Users can view messages from their sessions               |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_messages\` has a row level security policy \`Users can create messages in their sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.               | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_messages","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_messages_Users can create messages in their sessions               |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_messages\` has a row level security policy \`Users can update messages in their sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.               | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_messages","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_messages_Users can update messages in their sessions               |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_messages\` has a row level security policy \`Users can delete messages in their sessions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.               | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_messages","type":"table","schema":"public"}               | auth_rls_init_plan_public_chat_messages_Users can delete messages in their sessions               |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.user_usage_daily\` has a row level security policy \`Users can view their own usage\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                         | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"user_usage_daily","type":"table","schema":"public"}            | auth_rls_init_plan_public_user_usage_daily_Users can view their own usage                         |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.user_usage_daily\` has a row level security policy \`Users can insert their own usage\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                       | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"user_usage_daily","type":"table","schema":"public"}            | auth_rls_init_plan_public_user_usage_daily_Users can insert their own usage                       |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.user_usage_daily\` has a row level security policy \`Users can update their own usage\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                       | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"user_usage_daily","type":"table","schema":"public"}            | auth_rls_init_plan_public_user_usage_daily_Users can update their own usage                       |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.profiles\` has a row level security policy \`Admins can view any profile\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                                    | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"profiles","type":"table","schema":"public"}                    | auth_rls_init_plan_public_profiles_Admins can view any profile                                    |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.profiles\` has a row level security policy \`Admins can update any profile\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                                  | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"profiles","type":"table","schema":"public"}                    | auth_rls_init_plan_public_profiles_Admins can update any profile                                  |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.model_sync_log\` has a row level security policy \`Only admins can view sync logs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                           | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"model_sync_log","type":"table","schema":"public"}              | auth_rls_init_plan_public_model_sync_log_Only admins can view sync logs                           |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.model_sync_log\` has a row level security policy \`Admins can insert sync logs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                              | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"model_sync_log","type":"table","schema":"public"}              | auth_rls_init_plan_public_model_sync_log_Admins can insert sync logs                              |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.model_sync_log\` has a row level security policy \`Admins can update sync logs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                              | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"model_sync_log","type":"table","schema":"public"}              | auth_rls_init_plan_public_model_sync_log_Admins can update sync logs                              |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.admin_audit_log\` has a row level security policy \`Only admins can read audit logs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                         | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"admin_audit_log","type":"table","schema":"public"}             | auth_rls_init_plan_public_admin_audit_log_Only admins can read audit logs                         |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.message_token_costs\` has a row level security policy \`Users can view their own message costs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.              | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"message_token_costs","type":"table","schema":"public"}         | auth_rls_init_plan_public_message_token_costs_Users can view their own message costs              |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.message_token_costs\` has a row level security policy \`Admins can view all message costs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                   | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"message_token_costs","type":"table","schema":"public"}         | auth_rls_init_plan_public_message_token_costs_Admins can view all message costs                   |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.message_token_costs\` has a row level security policy \`Users can insert their own message costs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.            | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"message_token_costs","type":"table","schema":"public"}         | auth_rls_init_plan_public_message_token_costs_Users can insert their own message costs            |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.message_token_costs\` has a row level security policy \`Admins can insert any message costs\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"message_token_costs","type":"table","schema":"public"}         | auth_rls_init_plan_public_message_token_costs_Admins can insert any message costs                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_attachments\` has a row level security policy \`Users can view their own attachments\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                   | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_attachments","type":"table","schema":"public"}            | auth_rls_init_plan_public_chat_attachments_Users can view their own attachments                   |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_attachments\` has a row level security policy \`Users can insert their own attachments\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_attachments","type":"table","schema":"public"}            | auth_rls_init_plan_public_chat_attachments_Users can insert their own attachments                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_attachments\` has a row level security policy \`Users can update their own attachments\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_attachments","type":"table","schema":"public"}            | auth_rls_init_plan_public_chat_attachments_Users can update their own attachments                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_attachments\` has a row level security policy \`Users can delete their own attachments\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_attachments","type":"table","schema":"public"}            | auth_rls_init_plan_public_chat_attachments_Users can delete their own attachments                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_message_annotations\` has a row level security policy \`Users can view their own message annotations\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.   | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_message_annotations","type":"table","schema":"public"}    | auth_rls_init_plan_public_chat_message_annotations_Users can view their own message annotations   |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_message_annotations\` has a row level security policy \`Users can insert their own message annotations\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info. | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_message_annotations","type":"table","schema":"public"}    | auth_rls_init_plan_public_chat_message_annotations_Users can insert their own message annotations |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.chat_message_annotations\` has a row level security policy \`Users can delete their own message annotations\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info. | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"chat_message_annotations","type":"table","schema":"public"}    | auth_rls_init_plan_public_chat_message_annotations_Users can delete their own message annotations |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.cta_events\` has a row level security policy \`Admin can read CTA events\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                                    | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"cta_events","type":"table","schema":"public"}                  | auth_rls_init_plan_public_cta_events_Admin can read CTA events                                    |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.cta_events\` has a row level security policy \`Allow inserts from server roles\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                              | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"cta_events","type":"table","schema":"public"}                  | auth_rls_init_plan_public_cta_events_Allow inserts from server roles                              |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.anonymous_usage_daily\` has a row level security policy \`Admins can read anonymous usage\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                   | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"anonymous_usage_daily","type":"table","schema":"public"}       | auth_rls_init_plan_public_anonymous_usage_daily_Admins can read anonymous usage                   |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.anonymous_model_usage_daily\` has a row level security policy \`Admins can read anonymous model usage\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.       | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"anonymous_model_usage_daily","type":"table","schema":"public"} | auth_rls_init_plan_public_anonymous_model_usage_daily_Admins can read anonymous model usage       |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.anonymous_error_events\` has a row level security policy \`Admins can read anonymous errors\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"anonymous_error_events","type":"table","schema":"public"}      | auth_rls_init_plan_public_anonymous_error_events_Admins can read anonymous errors                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.moderation_actions\` has a row level security policy \`Admins can view moderation actions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                   | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"moderation_actions","type":"table","schema":"public"}          | auth_rls_init_plan_public_moderation_actions_Admins can view moderation actions                   |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.moderation_actions\` has a row level security policy \`Admins can insert moderation actions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"moderation_actions","type":"table","schema":"public"}          | auth_rls_init_plan_public_moderation_actions_Admins can insert moderation actions                 |
| auth_rls_initplan            | Auth RLS Initialization Plan | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if calls to \`current_setting()\` and \`auth.<function>()\` in RLS policies are being unnecessarily re-evaluated for each row                                                                                                                       | Table \`public.moderation_actions\` has a row level security policy \`Admins can update moderation actions\` that re-evaluates current_setting() or auth.<function>() for each row. This produces suboptimal query performance at scale. Resolve the issue by replacing \`auth.<function>()\` with \`(select auth.<function>())\`. See [docs](https://supabase.com/docs/guides/database/postgres/row-level-security#call-functions-with-select) for more info.                 | https://supabase.com/docs/guides/database/database-linter?lint=0003_auth_rls_initplan            | {"name":"moderation_actions","type":"table","schema":"public"}          | auth_rls_init_plan_public_moderation_actions_Admins can update moderation actions                 |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`anon\` for action \`INSERT\`. Policies include \`{"Admins can insert any message costs","Users can insert their own message costs"}\`                                                                                                                                                                                                                                                         | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_anon_INSERT                               |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`anon\` for action \`SELECT\`. Policies include \`{"Admins can view all message costs","Users can view their own message costs"}\`                                                                                                                                                                                                                                                             | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_anon_SELECT                               |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`authenticated\` for action \`INSERT\`. Policies include \`{"Admins can insert any message costs","Users can insert their own message costs"}\`                                                                                                                                                                                                                                                | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_authenticated_INSERT                      |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`authenticated\` for action \`SELECT\`. Policies include \`{"Admins can view all message costs","Users can view their own message costs"}\`                                                                                                                                                                                                                                                    | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_authenticated_SELECT                      |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`authenticator\` for action \`INSERT\`. Policies include \`{"Admins can insert any message costs","Users can insert their own message costs"}\`                                                                                                                                                                                                                                                | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_authenticator_INSERT                      |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`authenticator\` for action \`SELECT\`. Policies include \`{"Admins can view all message costs","Users can view their own message costs"}\`                                                                                                                                                                                                                                                    | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_authenticator_SELECT                      |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`dashboard_user\` for action \`INSERT\`. Policies include \`{"Admins can insert any message costs","Users can insert their own message costs"}\`                                                                                                                                                                                                                                               | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_dashboard_user_INSERT                     |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.message_token_costs\` has multiple permissive policies for role \`dashboard_user\` for action \`SELECT\`. Policies include \`{"Admins can view all message costs","Users can view their own message costs"}\`                                                                                                                                                                                                                                                   | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"message_token_costs","type":"table","schema":"public"}         | multiple_permissive_policies_public_message_token_costs_dashboard_user_SELECT                     |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`anon\` for action \`SELECT\`. Policies include \`{"Admins can view any profile","Users can view their own profile"}\`                                                                                                                                                                                                                                                                                    | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_anon_SELECT                                          |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`anon\` for action \`UPDATE\`. Policies include \`{"Admins can update any profile","Users can update their own profile"}\`                                                                                                                                                                                                                                                                                | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_anon_UPDATE                                          |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`authenticated\` for action \`SELECT\`. Policies include \`{"Admins can view any profile","Users can view their own profile"}\`                                                                                                                                                                                                                                                                           | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_authenticated_SELECT                                 |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`authenticated\` for action \`UPDATE\`. Policies include \`{"Admins can update any profile","Users can update their own profile"}\`                                                                                                                                                                                                                                                                       | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_authenticated_UPDATE                                 |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`authenticator\` for action \`SELECT\`. Policies include \`{"Admins can view any profile","Users can view their own profile"}\`                                                                                                                                                                                                                                                                           | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_authenticator_SELECT                                 |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`authenticator\` for action \`UPDATE\`. Policies include \`{"Admins can update any profile","Users can update their own profile"}\`                                                                                                                                                                                                                                                                       | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_authenticator_UPDATE                                 |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`dashboard_user\` for action \`SELECT\`. Policies include \`{"Admins can view any profile","Users can view their own profile"}\`                                                                                                                                                                                                                                                                          | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_dashboard_user_SELECT                                |
| multiple_permissive_policies | Multiple Permissive Policies | WARN  | EXTERNAL | ["PERFORMANCE"] | Detects if multiple permissive row level security policies are present on a table for the same \`role\` and \`action\` (e.g. insert). Multiple permissive policies are suboptimal for performance as each policy must be executed for every relevant query. | Table \`public.profiles\` has multiple permissive policies for role \`dashboard_user\` for action \`UPDATE\`. Policies include \`{"Admins can update any profile","Users can update their own profile"}\`                                                                                                                                                                                                                                                                      | https://supabase.com/docs/guides/database/database-linter?lint=0006_multiple_permissive_policies | {"name":"profiles","type":"table","schema":"public"}                    | multiple_permissive_policies_public_profiles_dashboard_user_UPDATE                                |

## Analysis and decisions (2025-09-12)

Summary

- auth_rls_initplan: Fix across the board (low-risk hardening, performance-only). Prioritize hot-path tables first.
- multiple_permissive_policies: Recommended to consolidate where semantics allow; can defer for admin-only/low-traffic tables.

Details by category

- auth_rls_initplan  Auth RLS Initialization Plan

  - What it means: Policies that call auth.<fn>() or current_setting(...) directly can be re-evaluated per row. Wrapping them in a scalar subquery forces a one-time evaluation, improving plans at scale.
  - Remediation pattern (no behavior change):
    - Replace auth.uid()  (select auth.uid())
    - Replace auth.role()  (select auth.role())
    - Replace current_setting('request.jwt.claim.sub', true)  (select current_setting('request.jwt.claim.sub', true))
    - Apply inside USING and WITH CHECK of the affected policies.
  - Fix decisions and priority:
    - High priority (user-facing, frequent access):
      - public.profiles  policies: Users can view/update/insert their own profile; Admins can view/update any profile  Fix
      - public.chat_sessions  view/create/update/delete own sessions  Fix
      - public.chat_messages  view/create/update/delete in own sessions  Fix
      - public.message_token_costs  user/admin view/insert paths  Fix
    - Medium priority:
      - public.chat_attachments  all CRUD  Fix
      - public.chat_message_annotations  view/insert/delete own  Fix
      - public.user_activity_log  view own activity  Fix
      - public.user_usage_daily  view/insert/update own  Fix
    - Low priority (admin-only/operational):
      - public.model_sync_log  admin view/insert/update  Fix (can defer)
      - public.admin_audit_log  admin read  Fix (can defer)
      - public.cta_events  admin read; server inserts  Fix (can defer)
      - public.anonymous_usage_daily, public.anonymous_model_usage_daily, public.anonymous_error_events  admin read  Fix (can defer)
      - public.moderation_actions  admin view/insert/update  Fix (can defer)

- multiple_permissive_policies  Multiple Permissive Policies
  - What it means: For the same table+role+action, more than one permissive policy exists, so Postgres evaluates multiple expressions and ORs them. Works functionally, but adds overhead and can obscure intent.
  - Remediation options:
    - Consolidate into a single policy per table+role+action with an OR of conditions, e.g. USING (is_admin() OR user_id = (select auth.uid())).
    - Alternatively, keep separate policies for clarity and accept minor overhead (safe to defer on low-traffic paths).
  - Decisions:
    - public.message_token_costs  roles anon/authenticated/authenticator/dashboard_user for SELECT and INSERT have duplicate permissive policies  Recommended: Consolidate per role/action. Keep behavior identical by OR-combining Admins can  with Users can . Priority: High (hot-path analytics).
    - public.profiles  roles anon/authenticated/authenticator/dashboard_user for SELECT/UPDATE have duplicate permissive policies  Recommended: Consolidate per role/action. Priority: Medium (moderate frequency; still worth simplifying).

Implementation notes (for future patch)

- Use ALTER POLICY to update USING/WITH CHECK in place (no drop needed):
  - ALTER POLICY policy_name ON schema.table USING (<updated_expr>) WITH CHECK (<updated_expr>);
- Validate with EXPLAIN to confirm initplan optimization on representative queries.
- No app code changes expected; behavior remains identical when expressions are semantically preserved.

Verification checklist

- Re-run the Performance Advisor after changes; all listed auth_rls_initplan warnings should clear.
- For multiple_permissive_policies, the duplicates should disappear where consolidation was applied.
